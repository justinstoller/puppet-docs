<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Documentation | Puppet Labs - Using Parameterized Classes</title>
  	<meta name="description" content="The open source leader in data center automation">
  	<link rel="alternate" type="text/xml" title="Puppet Labs RSS 0.92 Feed" href="http://puppetlabs.com/feed/rss/">
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Atom Feed" href="http://puppetlabs.com/feed/atom/">
  	<link rel="alternate" type="application/rss+xml" title="Puppet Labs RSS 2.0 Feed" href="http://puppetlabs.com/feed/">
  	<link rel="pingback" href="http://puppetlabs.com/xmlrpc.php">
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://puppetlabs.com/xmlrpc.php?rsd" />
    <link rel='index' title='Puppet Labs' href='http://docs.puppetlabs.com' />

<!-- Google stats -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-1537572-5");
pageTracker._setDomainName(".puppetlabs.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- End Google stats -->


    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='/files/javascripts/html5.js'></script>
    <script type='text/javascript' src='/files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='/files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='/files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='/files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='/files/javascripts/ampersands.js'></script>

     <!--Add rotation jQuery Script -->
	 	
    <script type='text/javascript' src='/files/javascripts/addRotate.js'></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <link rel="canonical" href="http://docs.puppetlabs.com" />
    <!-- /all in one seo pack -->
	
    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="/files/stylesheets/style.css" media="screen"> 
    <link rel="stylesheet" type="text/css" href="/files/stylesheets/syntax.css" media="screen"> <!-- index -->
    <link rel="stylesheet" type="text/css" href="/files/stylesheets/adbanner.css" media="screen">

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->
  
    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->		

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>



        
  <body id="puppetlabsdocs" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>		
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->		

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/puppet/">
              <span>Products</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>            
              <li>
                <ul>
<li class="page_item page-item-769"><a href="http://www.puppetlabs.com/puppet/puppet-enterprise/" title="Puppet Enterprise">Puppet Enterprise</a></li>
<li class="page_item page-item-757"><a href="http://www.puppetlabs.com/puppet/introduction/" title="Puppet">Puppet</a></li>
<li class="page_item page-item-956"><a href="http://www.puppetlabs.com/puppet/how-to-buy/" title="How to Buy">How to Buy</a></li>
<li class="page_item page-item-1159"><a href="http://forge.puppetlabs.com/" title="Module Forge">Module Forge</a></li>

<li class="page_item page-item-2415"><a href="http://www.puppetlabs.com/mcollective/introduction/" title="MCollective">MCollective</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>

            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://www.puppetlabs.com/services/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-839"><a href="http://www.puppetlabs.com/services/support/" title="Enterprise Support">Enterprise Support</a></li>
<li class="page_item page-item-845"><a href="http://www.puppetlabs.com/services/training-workshops/" title="On-Site Training &amp; Consulting">On-Site Training &amp; Consulting</a></li>
<li class="page_item page-item-849"><a href="/category/events/upcoming/" title="Events &amp; Public Training">Events &amp; Public Training</a></li>
<li class="page_item page-item-851"><a href="http://www.puppetlabs.com/services/partners/" title="Partners">Partners</a></li>
<li class="page_item page-item-1037"><a href="/resources/customer-support" title="Customer Support">Customer Support</a></li>
            </ul>
          </li>
          <li id="resources-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/resources/">
              <span>Resources</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://www.puppetlabs.com/resources/overview-2/" title="Overview">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://www.puppetlabs.com/resources/customer-support/" title="Customer Support">Customer Support</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com" title="Documentation">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download" title="Downloads">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com" title="Module Forge">Module Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/request-whitepapers.html" title="White Papers">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki" title="Wiki">Wiki</a></li>
            </ul>

          </li>

<li id="customer-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/customers/companies/">
              <span>Customers</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://www.puppetlabs.com/customers/companies/" title="Overview">Companies</a></li>
<li class="page_item page-item-1052"><a href="http://www.puppetlabs.com/customers/case-studies/" title="Case Studies">Case Studies</a></li>
<li class="page_item page-item-1040"><a href="http://www.puppetlabs.com/customers/product-testimonials/" title="Product Testimonials">Product Testimonials</a></li>
<li class="page_item page-item-872"><a href="http://www.puppetlabs.com/customers/what-customers-are-saying/" title="ervice Testimonials">Service Testimonials</a></li>
	</ul>
          </li>
         <li id="community-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/community/">
              <span>Community</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2195"><a href="http://www.puppetlabs.com/community/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2195"><a href="http://www.puppetlabs.com/blog" title="Blog">Blog</a></li>
<li class="page_item page-item-2264"><a href="http://www.puppetlabs.com/community/puppet-camp/" title="Puppet Camp">Puppet Camp</a></li>
<li class="page_item page-item-2249"><a href="http://www.puppetlabs.com/community/user-groups-and-devops-groups/" title="User Groups &amp; DevOps Groups">User Groups &amp; DevOps Groups</a></li>
<li class="page_item page-item-2215"><a href="http://www.puppetlabs.com/community/presentations/" title="Presentations">Presentations</a></li>

<li class="page_item page-item-2217"><a href="http://www.puppetlabs.com/community/videos/" title="Videos">Videos</a></li>
<li class="page_item page-item-2217"><a href="http://www.puppetlabs.com/community/badges/" title="Badges">Badges</a></li>
            </ul>
          </li>

          <li id="company-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>

            <ul>
              <li class="page_item page-item-2316"><a href="http://www.puppetlabs.com/company/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://www.puppetlabs.com/company/news/" title="News">News</a></li>
<li class="page_item page-item-1571"><a href="http://www.puppetlabs.com/company/jobs/" title="Jobs">Jobs</a></li>
<li class="page_item page-item-2313"><a href="http://www.puppetlabs.com/company/contact-us/" title="Contact Us">Contact Us</a></li>
            </ul>
          </li>
    		</ul>	   
          <div id="misc-navigation">

			  <ul>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
				<li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/#contact">Contact Us</a></li>
				<li><a href="http://puppetlabs.com/resources/downloads" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">

			  <div>
				<input type="hidden" name="cx" value="017884045025332504017:1mnj-dlgfcc" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>

          </div>
      </nav>
    	</div>
    </header>  

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Using Parameterized Classes</span></h1>
          <ul id="doc-navigation">
            <li><a href="/">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
               	            <dl>
	              <dt>Puppet Guides</dt>
                      <dd><a href="/index.html">Index</a></dd>
                  <dt>Puppet References</dt>
                      <dd><a href="/references/stable/type.html">Resource Types</a></dd>
                      <dd><a href="/references/stable/function.html">Functions</a></dd>
                      <dd><a href="/references/stable/metaparameter.html">Metaparameters</a></dd>
                      <dd><a href="/references/stable/configuration.html">Configuration</a></dd>
                      <dt>References By Version</dt>
                      <dd><a href="/references/2.7.3/">2.7.3</a></dd>
                      <dd><a href="/references/2.6.9/">2.6.9</a></dd>
                      <dd><a href="/references/0.25.5/">0.25.5</a></dd>
                      <dd><a href="/references/0.24.8/">0.24.8</a></dd>
                      <dd><a href="/references/">Other Versions</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="/mcollective/index.html">Index</a></dd>
                      <dd><a href="/mcollective/simplerpc/index.html">SimpleRPC</a></dd>
                      <dd><a href="/mcollective/roadmap/index.html">Roadmap</a></dd>
                      <dd><a href="/mcollective/releasenotes.html">Release Notes</a></dd>
                      <dd><a href="/mcollective/reference/index.html">References</a></dd>
	            </dl>

            </li>
            <li><a href="/contribute.html">Contribute</a></li>
          </ul>
        </div>
      </section>
    
      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1 id="using-parameterized-classes">Using Parameterized Classes</h1>

<p>Use parameterized classes to write more effective, versatile, and encapsulated code. </p>

<hr />

<h2 id="why-and-some-history">Why, and Some History</h2>

<p>Well-written and reusable classes often have to change their behavior based on where and how they&rsquo;re declared. However, due to the organic way the Puppet language grew, there was a long period where it didn&rsquo;t have a specific means to do this. </p>

<p>Most Puppet coders solved this by using dynamic variable lookup to pass parameters into classes. By making the class&rsquo;s effects pivot on a handful of variables not defined in the class, you could later set those variables at node scope or in another class, then declare the class and assign its <a href="./scope_and_puppet.html#appendix-how-scope-works-in-puppet--27x">parent scope</a>; at that point, the class would go looking for the information it needed and react accordingly. </p>

<p>This approach did the job and solved some really important problems, but it had major drawbacks: </p>

<ul>
  <li><strong>It basically exploded all variables into the global namespace.</strong> Since classes had to look outside their own scope for parameters, parameters were effectively global. That meant you had to anticipate what every other module author was going to name their variables and try to guess something safe. </li>
  <li><strong>Understanding how to declare a class was not exactly straightforward.</strong> There was no built-in way to tell what parameters a class needed to have set, so you were on your own for documenting it and following the rules to the letter. Optional parameters in particular could bite you at exactly the wrong time. </li>
  <li><strong>It was just plain confusing.</strong> The rules for how a parent scope is assigned can fit on an index card, but they can interact in some extraordinarily hairy ways. (<a href="./scope_and_puppet.html#appendix-how-scope-works-in-puppet--27x">ibid.</a>)</li>
</ul>

<p>So to shorten a long story, Puppet 2.6 introduced a better and more direct way to pass parameters into a class.</p>

<h2 id="philosophy">Philosophy</h2>

<p>A class that depends on dynamic scope for its parameters has to do its own research. Instead, you should supply it with a full dossier when you declare it. Start thinking in terms of passing information to the class, instead of in terms of setting variables and getting scope to act right. </p>

<h2 id="using-parameterized-classes-1">Using Parameterized Classes</h2>

<h3 id="writing-a-parameterized-class">Writing a Parameterized Class</h3>

<p>Parameterized classes are declared just like classical classes, but with a list of parameters (in parentheses) between the class name and the opening bracket: </p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">webserver</span><span class="p">(</span> <span class="vg">$vhost_dir</span><span class="p">,</span> <span class="vg">$packages</span> <span class="p">)</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>The parameters you name can be used as normal local variables throughout the class definition. In fact, the first step in converting a class to use parameters is to just locate all the variables you&rsquo;re expecting to find in an outer scope and call them out as parameters &mdash; you won&rsquo;t have to change how they&rsquo;re used inside the class at all. </p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">webserver</span><span class="p">(</span> <span class="vg">$vhost_dir</span><span class="p">,</span> <span class="vg">$packages</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">packages</span> <span class="p">{</span> <span class="vg">$packages</span><span class="p">:</span> <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span> <span class="p">}</span>
     
      <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;vhost_dir&#39;</span>
        <span class="n">path</span>   <span class="o">=&gt;</span> <span class="vg">$vhost_dir</span><span class="p">,</span>
        <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">directory</span><span class="p">,</span>
        <span class="n">mode</span>   <span class="o">=&gt;</span> <span class="s1">&#39;0750&#39;</span><span class="p">,</span>
        <span class="n">owner</span>  <span class="o">=&gt;</span> <span class="s1">&#39;www-data&#39;</span><span class="p">,</span>
        <span class="n">group</span>  <span class="o">=&gt;</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>You can also give default values for any parameter in the list:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">webserver</span><span class="p">(</span> <span class="vg">$vhost_dir</span> <span class="o">=</span> <span class="s1">&#39;/etc/httpd/conf.d&#39;</span><span class="p">,</span> <span class="vg">$packages</span> <span class="o">=</span> <span class="s1">&#39;httpd&#39;</span> <span class="p">)</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>Any parameter with a default value can be safely omitted when declaring the class. </p>

<h3 id="declaring-a-parameterized-class">Declaring a Parameterized Class</h3>

<p>This can be easy to forget when using the shorthand <code>include</code> function, but class instances are just resources. Since <code>include</code> wasn&rsquo;t designed for use with parameterized classes, you have to declare them like a normal resource: type, name, and attributes, in their normal order. The parameters you named when defining the class become the attributes you use when declaring it:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="p">{</span><span class="s1">&#39;webserver&#39;</span><span class="p">:</span>
      <span class="n">packages</span>  <span class="o">=&gt;</span> <span class="s1">&#39;apache2&#39;</span><span class="p">,</span>
      <span class="n">vhost_dir</span> <span class="o">=&gt;</span> <span class="s1">&#39;/etc/apache2/sites-enabled&#39;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>Or, if declaring with all default values:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="p">{</span><span class="s1">&#39;webserver&#39;</span><span class="p">:</span> <span class="p">}</span>
</code></pre>
</div>

<p>As of Puppet 2.6.5, parameterized classes can be declared by external node classifiers; see the <a href="./external_nodes.html">ENC documentation</a> for details. </p>

<h3 id="site-design-and-composition-with-parameterized-classes">Site Design and Composition With Parameterized Classes</h3>

<p>Once your classes are converted to use parameters, there&rsquo;s some work remaining to make sure your classes can work well together. </p>

<p>A common pattern with standard classes is to <code>include</code> any other classes that the class requires. Since <code>include</code> ensures a class is declared without redeclaring it, this has been a convenient way to satisfy dependencies. This won&rsquo;t work well with parameterized classes, though, for the reasons we&rsquo;ve mentioned above.</p>

<p>Instead, you should explicitly state your class&rsquo;s dependencies inside its definition using the relationship chaining syntax:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">webserver</span><span class="p">(</span> <span class="vg">$vhost_dir</span><span class="p">,</span> <span class="vg">$packages</span> <span class="p">)</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
      <span class="c1"># Make sure our ports are configured correctly:</span>
      <span class="no">Class</span><span class="o">[</span><span class="s1">&#39;iptables::webserver&#39;</span><span class="o">]</span> <span class="o">-&gt;</span> <span class="no">Class</span><span class="o">[</span><span class="s1">&#39;webserver&#39;</span><span class="o">]</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>Instead of implicitly declaring the required class, this will make sure that compilation throws an error if it&rsquo;s absent. From one perspective, this is less convenient; from another, it&rsquo;s less magical and more knowable. For those who prefer implicit declaration, we&rsquo;re working on a safe way to implicitly declare parameterized classes, but the design work isn&rsquo;t finished at the time of this writing.</p>

<p>Once you&rsquo;ve stated your class&rsquo;s dependencies, you&rsquo;ll need to declare the required classes when composing your node or wrapper class:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">tacoma_webguide_application_server</span> <span class="p">{</span>
      <span class="k">class</span> <span class="p">{</span><span class="s1">&#39;webserver&#39;</span><span class="p">:</span> 
        <span class="n">packages</span>  <span class="o">=&gt;</span> <span class="s1">&#39;apache2&#39;</span><span class="p">,</span>
        <span class="n">vhost_dir</span> <span class="o">=&gt;</span> <span class="s1">&#39;/etc/apache2/sites-enabled&#39;</span><span class="p">,</span>
      <span class="p">}</span>
      <span class="k">class</span> <span class="p">{</span><span class="s1">&#39;iptables::webserver&#39;</span><span class="p">:}</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>The general rule of thumb here is that you should only be declaring other classes in your outermost node or class definitions. </p>

<h2 id="further-reading">Further Reading</h2>

<p>For more information on modern Puppet class and module design, see the <a href="./style_guide.html">Puppet Labs style guide</a>. </p>

<h2 id="appendix-smart-parameter-defaults">Appendix: Smart Parameter Defaults</h2>

<p>This design pattern can make for significantly cleaner code while enabling some really sophisticated behavior around default values.</p>

<div class="highlight"><pre><code class="ruby">    <span class="c1"># /etc/puppet/modules/webserver/manifests/params.pp</span>
    
    <span class="k">class</span> <span class="n">webserver</span><span class="o">::</span><span class="n">params</span> <span class="p">{</span>
     <span class="vg">$packages</span> <span class="o">=</span> <span class="vg">$operatingsystem</span> <span class="p">?</span> <span class="p">{</span><span class="sr" />
<span class="sr">       /(?i-mx:ubuntu|debian)/</span>        <span class="o">=&gt;</span> <span class="s1">&#39;apache2&#39;</span><span class="p">,</span><span class="sr" />
<span class="sr">       /(?i-mx:centos|fedora|redhat)/</span> <span class="o">=&gt;</span> <span class="s1">&#39;httpd&#39;</span><span class="p">,</span>
     <span class="p">}</span>
     <span class="vg">$vhost_dir</span> <span class="o">=</span> <span class="vg">$operatingsystem</span> <span class="p">?</span> <span class="p">{</span><span class="sr" />
<span class="sr">       /(?i-mx:ubuntu|debian)/</span>        <span class="o">=&gt;</span> <span class="s1">&#39;/etc/apache2/sites-enabled&#39;</span><span class="p">,</span><span class="sr" />
<span class="sr">       /(?i-mx:centos|fedora|redhat)/</span> <span class="o">=&gt;</span> <span class="s1">&#39;/etc/httpd/conf.d&#39;</span><span class="p">,</span>
     <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1"># /etc/puppet/modules/webserver/manifests/init.pp</span>
    
    <span class="k">class</span> <span class="n">webserver</span><span class="p">(</span>
     <span class="vg">$packages</span>  <span class="o">=</span> <span class="vg">$webserver</span><span class="o">::</span><span class="n">params</span><span class="o">::</span><span class="n">packages</span><span class="p">,</span>
     <span class="vg">$vhost_dir</span> <span class="o">=</span> <span class="vg">$webserver</span><span class="o">::</span><span class="n">params</span><span class="o">::</span><span class="n">vhost_dir</span>
    <span class="p">)</span> <span class="n">inherits</span> <span class="vg">$webserver</span><span class="o">::</span><span class="n">params</span> <span class="p">{</span>
    
     <span class="n">packages</span> <span class="p">{</span> <span class="vg">$packages</span><span class="p">:</span> <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span> <span class="p">}</span>
    
     <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;vhost_dir&#39;</span>
       <span class="n">path</span>   <span class="o">=&gt;</span> <span class="vg">$vhost_dir</span><span class="p">,</span>
       <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">directory</span><span class="p">,</span>
       <span class="n">mode</span>   <span class="o">=&gt;</span> <span class="s1">&#39;0750&#39;</span><span class="p">,</span>
       <span class="n">owner</span>  <span class="o">=&gt;</span> <span class="s1">&#39;www-data&#39;</span><span class="p">,</span>
       <span class="n">group</span>  <span class="o">=&gt;</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
     <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>To summarize what&rsquo;s happening here: When a class inherits from another class, it implicitly declares the base class. Since the base class&rsquo;s local scope already exists before the new class&rsquo;s parameters get declared, those parameters can be set based on information in the base class. </p>

<p>This is functionally equivalent to doing the following:</p>

<div class="highlight"><pre><code class="ruby">    <span class="c1"># /etc/puppet/modules/webserver/manifests/init.pp</span>
    
    <span class="k">class</span> <span class="n">webserver</span><span class="p">(</span> <span class="vg">$packages</span> <span class="o">=</span> <span class="s1">&#39;UNSET&#39;</span><span class="p">,</span> <span class="vg">$vhost_dir</span> <span class="o">=</span> <span class="s1">&#39;UNSET&#39;</span> <span class="p">)</span> <span class="p">{</span>
     
     <span class="k">if</span> <span class="vg">$packages</span> <span class="o">==</span> <span class="s1">&#39;UNSET&#39;</span> <span class="p">{</span>
       <span class="vg">$real_packages</span> <span class="o">=</span> <span class="vg">$operatingsystem</span> <span class="p">?</span> <span class="p">{</span><span class="sr" />
<span class="sr">         /(?i-mx:ubuntu|debian)/</span>        <span class="o">=&gt;</span> <span class="s1">&#39;apache2&#39;</span><span class="p">,</span><span class="sr" />
<span class="sr">         /(?i-mx:centos|fedora|redhat)/</span> <span class="o">=&gt;</span> <span class="s1">&#39;httpd&#39;</span><span class="p">,</span>
       <span class="p">}</span>
     <span class="p">}</span>
     <span class="k">else</span> <span class="p">{</span>
        <span class="vg">$real_packages</span> <span class="o">=</span> <span class="vg">$packages</span>
     <span class="p">}</span>
     
     <span class="k">if</span> <span class="vg">$vhost_dir</span> <span class="o">==</span> <span class="s1">&#39;UNSET&#39;</span> <span class="p">{</span>
       <span class="vg">$real_vhost_dir</span> <span class="o">=</span> <span class="vg">$operatingsystem</span> <span class="p">?</span> <span class="p">{</span><span class="sr" />
<span class="sr">         /(?i-mx:ubuntu|debian)/</span>        <span class="o">=&gt;</span> <span class="s1">&#39;/etc/apache2/sites-enabled&#39;</span><span class="p">,</span><span class="sr" />
<span class="sr">         /(?i-mx:centos|fedora|redhat)/</span> <span class="o">=&gt;</span> <span class="s1">&#39;/etc/httpd/conf.d&#39;</span><span class="p">,</span>
       <span class="p">}</span>
     <span class="p">}</span>
     <span class="k">else</span> <span class="p">{</span>
        <span class="vg">$real_vhost_dir</span> <span class="o">=</span> <span class="vg">$vhost_dir</span>
    <span class="p">}</span>
     
     <span class="n">packages</span> <span class="p">{</span> <span class="vg">$real_packages</span><span class="p">:</span> <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span> <span class="p">}</span>
    
     <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;vhost_dir&#39;</span>
       <span class="n">path</span>   <span class="o">=&gt;</span> <span class="vg">$real_vhost_dir</span><span class="p">,</span>
       <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">directory</span><span class="p">,</span>
       <span class="n">mode</span>   <span class="o">=&gt;</span> <span class="s1">&#39;0750&#39;</span><span class="p">,</span>
       <span class="n">owner</span>  <span class="o">=&gt;</span> <span class="s1">&#39;www-data&#39;</span><span class="p">,</span>
       <span class="n">group</span>  <span class="o">=&gt;</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
     <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>&hellip; but it&rsquo;s a significant readability win, especially if the amount of logic or the number of parameters gets any higher than what&rsquo;s shown in the example.</p>

            </div>
            <div class="secondary-content">
                  <div id="subCol">
                  
                  
                      <h3 class="chapter">Contents</h3>
                      
<ol class="toc">
  <li class="toc-lv2"><a href="#why-and-some-history">Why, and Some History</a></li>
  <li class="toc-lv2"><a href="#philosophy">Philosophy</a></li>
  <li class="toc-lv2"><a href="#using-parameterized-classes-1">Using Parameterized Classes</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#writing-a-parameterized-class">Writing a Parameterized Class</a></li>
   <li class="toc-lv3"><a href="#declaring-a-parameterized-class">Declaring a Parameterized Class</a></li>
   <li class="toc-lv3"><a href="#site-design-and-composition-with-parameterized-classes">Site Design and Composition With Parameterized Classes</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#further-reading">Further Reading</a></li>
  <li class="toc-lv2"><a href="#appendix-smart-parameter-defaults">Appendix: Smart Parameter Defaults</a></li>
</ol>
                  
                                        <!-- New Ads are inserted here -->
		  			<div id="bannerImage" style="display:block;">&nbsp;</div>
		  			<!-- Remove me on September 24 --><a href="http://bit.ly/puppetconf"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/07/120x600_puppetconf.png" style="display:block; margin-left: auto; margin-right: auto;"></a>
                  </div>
            </div>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>  
		<h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>
              
				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save"; id="mktForm_1013" name="mktForm_1013">
				
				<label>Email Address:</label><span class='mktInput'><input class='mktFormText mktFormEmail' name="Email" id="Email" type='text' value="" maxlength='255'  /><span class='mktFormMsg'></span></span>
				
				<input id='mktFrmSubmit' type='submit' class='btn' style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value='Subscribe' name='submitButton' onclick='formSubmit(document.getElementById("mktForm_1013")); return false;' />
				
				<input style='display: none;' id='mktFrmReset' type='reset' value='Clear' name='resetButton' onclick='formReset(document.getElementById("mktForm_1013")); return false;' />
	
				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />
				
				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&kw={keyword}"; />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>
				
				<script type="text/javascript">
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				</script>
              
<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>
                
                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>	

              </ul>
		<p>
		              		<h4>Follow us&#8230;</h4>

              		<ul class="followus">

					
			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0"></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0"></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0"></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0"></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0"></a></li>
					</ul>

              	</p>

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>Written by James Turnbull and Jeff McCune, <a href="http://www.apress.com/9781430230571" rel="nofollow">Pro Puppet</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430230571" rel="nofollow"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/05/propuppetthumb.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">411 NW Park Avenue</span>
           /
           <span class="locality">Portland</span>, 
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>          
      </div>
    </div>
    <script src="http://munchkin.marketo.net/munchkin.js" type="text/javascript"></script> <script>mktoMunchkin("307-QLA-991");</script> 
    
  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>

	</body>
</html>        
