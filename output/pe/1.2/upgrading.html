<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Documentation | Puppet Labs - PE 1.2 Manual: Upgrading Puppet Enterprise </title>
  	<meta name="description" content="The open source leader in data center automation">
  	<link rel="alternate" type="text/xml" title="Puppet Labs RSS 0.92 Feed" href="http://puppetlabs.com/feed/rss/">
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Atom Feed" href="http://puppetlabs.com/feed/atom/">
  	<link rel="alternate" type="application/rss+xml" title="Puppet Labs RSS 2.0 Feed" href="http://puppetlabs.com/feed/">
  	<link rel="pingback" href="http://puppetlabs.com/xmlrpc.php">
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://puppetlabs.com/xmlrpc.php?rsd" />
    <link rel='index' title='Puppet Labs' href='http://docs.puppetlabs.com' />

<!-- Google stats -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-1537572-5");
pageTracker._setDomainName(".puppetlabs.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- End Google stats -->


    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='/files/javascripts/html5.js'></script>
    <script type='text/javascript' src='/files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='/files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='/files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='/files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='/files/javascripts/ampersands.js'></script>

     <!--Add rotation jQuery Script -->
	 	
    <script type='text/javascript' src='/files/javascripts/addRotate.js'></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <link rel="canonical" href="http://docs.puppetlabs.com" />
    <!-- /all in one seo pack -->
	
    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="/files/stylesheets/style.css" media="screen"> 
    <link rel="stylesheet" type="text/css" href="/files/stylesheets/syntax.css" media="screen"> <!-- index -->
    <link rel="stylesheet" type="text/css" href="/files/stylesheets/adbanner.css" media="screen">

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->
  
    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->		

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>



        
  <body id="puppetlabsdocs" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>		
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->		

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/puppet/">
              <span>Products</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>            
              <li>
                <ul>
<li class="page_item page-item-769"><a href="http://www.puppetlabs.com/puppet/puppet-enterprise/" title="Puppet Enterprise">Puppet Enterprise</a></li>
<li class="page_item page-item-757"><a href="http://www.puppetlabs.com/puppet/introduction/" title="Puppet">Puppet</a></li>
<li class="page_item page-item-956"><a href="http://www.puppetlabs.com/puppet/how-to-buy/" title="How to Buy">How to Buy</a></li>
<li class="page_item page-item-1159"><a href="http://forge.puppetlabs.com/" title="Module Forge">Module Forge</a></li>

<li class="page_item page-item-2415"><a href="http://www.puppetlabs.com/mcollective/introduction/" title="MCollective">MCollective</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>

            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://www.puppetlabs.com/services/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-839"><a href="http://www.puppetlabs.com/services/support/" title="Enterprise Support">Enterprise Support</a></li>
<li class="page_item page-item-845"><a href="http://www.puppetlabs.com/services/training-workshops/" title="On-Site Training &amp; Consulting">On-Site Training &amp; Consulting</a></li>
<li class="page_item page-item-849"><a href="/category/events/upcoming/" title="Events &amp; Public Training">Events &amp; Public Training</a></li>
<li class="page_item page-item-851"><a href="http://www.puppetlabs.com/services/partners/" title="Partners">Partners</a></li>
<li class="page_item page-item-1037"><a href="/resources/customer-support" title="Customer Support">Customer Support</a></li>
            </ul>
          </li>
          <li id="resources-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/resources/">
              <span>Resources</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://www.puppetlabs.com/resources/overview-2/" title="Overview">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://www.puppetlabs.com/resources/customer-support/" title="Customer Support">Customer Support</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com" title="Documentation">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download" title="Downloads">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com" title="Module Forge">Module Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/request-whitepapers.html" title="White Papers">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki" title="Wiki">Wiki</a></li>
            </ul>

          </li>

<li id="customer-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/customers/companies/">
              <span>Customers</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://www.puppetlabs.com/customers/companies/" title="Overview">Companies</a></li>
<li class="page_item page-item-1052"><a href="http://www.puppetlabs.com/customers/case-studies/" title="Case Studies">Case Studies</a></li>
<li class="page_item page-item-1040"><a href="http://www.puppetlabs.com/customers/product-testimonials/" title="Product Testimonials">Product Testimonials</a></li>
<li class="page_item page-item-872"><a href="http://www.puppetlabs.com/customers/what-customers-are-saying/" title="ervice Testimonials">Service Testimonials</a></li>
	</ul>
          </li>
         <li id="community-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/community/">
              <span>Community</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2195"><a href="http://www.puppetlabs.com/community/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2195"><a href="http://www.puppetlabs.com/blog" title="Blog">Blog</a></li>
<li class="page_item page-item-2264"><a href="http://www.puppetlabs.com/community/puppet-camp/" title="Puppet Camp">Puppet Camp</a></li>
<li class="page_item page-item-2249"><a href="http://www.puppetlabs.com/community/user-groups-and-devops-groups/" title="User Groups &amp; DevOps Groups">User Groups &amp; DevOps Groups</a></li>
<li class="page_item page-item-2215"><a href="http://www.puppetlabs.com/community/presentations/" title="Presentations">Presentations</a></li>

<li class="page_item page-item-2217"><a href="http://www.puppetlabs.com/community/videos/" title="Videos">Videos</a></li>
<li class="page_item page-item-2217"><a href="http://www.puppetlabs.com/community/badges/" title="Badges">Badges</a></li>
            </ul>
          </li>

          <li id="company-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>

            <ul>
              <li class="page_item page-item-2316"><a href="http://www.puppetlabs.com/company/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://www.puppetlabs.com/company/news/" title="News">News</a></li>
<li class="page_item page-item-1571"><a href="http://www.puppetlabs.com/company/jobs/" title="Jobs">Jobs</a></li>
<li class="page_item page-item-2313"><a href="http://www.puppetlabs.com/company/contact-us/" title="Contact Us">Contact Us</a></li>
            </ul>
          </li>
    		</ul>	   
          <div id="misc-navigation">

			  <ul>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
				<li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/#contact">Contact Us</a></li>
				<li><a href="http://puppetlabs.com/resources/downloads" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">

			  <div>
				<input type="hidden" name="cx" value="017884045025332504017:1mnj-dlgfcc" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>

          </div>
      </nav>
    	</div>
    </header>  

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">PE 1.2 Manual: Upgrading Puppet Enterprise </span></h1>
          <ul id="doc-navigation">
            <li><a href="/">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
               	            <dl>
	              <dt>Puppet Guides</dt>
                      <dd><a href="/index.html">Index</a></dd>
                  <dt>Puppet References</dt>
                      <dd><a href="/references/stable/type.html">Resource Types</a></dd>
                      <dd><a href="/references/stable/function.html">Functions</a></dd>
                      <dd><a href="/references/stable/metaparameter.html">Metaparameters</a></dd>
                      <dd><a href="/references/stable/configuration.html">Configuration</a></dd>
                      <dt>References By Version</dt>
                      <dd><a href="/references/2.7.3/">2.7.3</a></dd>
                      <dd><a href="/references/2.6.9/">2.6.9</a></dd>
                      <dd><a href="/references/0.25.5/">0.25.5</a></dd>
                      <dd><a href="/references/0.24.8/">0.24.8</a></dd>
                      <dd><a href="/references/">Other Versions</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="/mcollective/index.html">Index</a></dd>
                      <dd><a href="/mcollective/simplerpc/index.html">SimpleRPC</a></dd>
                      <dd><a href="/mcollective/roadmap/index.html">Roadmap</a></dd>
                      <dd><a href="/mcollective/releasenotes.html">Release Notes</a></dd>
                      <dd><a href="/mcollective/reference/index.html">References</a></dd>
	            </dl>

            </li>
            <li><a href="/contribute.html">Contribute</a></li>
          </ul>
        </div>
      </section>
    
      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <!-- 
#### Navigation

- [Introduction](./intro.html)
- [Overview](./overview.html)
- [Installing](./installing.html)
- [Upgrading](./upgrading.html)
- [Using Puppet Enterprise](./using.html)
- The Accounts Module
    - [The `accounts::user` Type](./accounts_user_type.html)
    - [The `accounts` Class](./accounts_class.html)
- Puppet Compliance
    - [Puppet Compliance Basics and UI](./compliance_basics.html)
    - [Using the Puppet Compliance Workflow](./using_compliance.html)
    - [Compliance Workflow Tutorial](./compliance_tutorial.html)
- [Known Issues](./known_issues.html)
- [Troubleshooting](./troubleshooting.html)
- [Answer File Reference](./answer_file_reference.html)

find:
(?<=^<li>)(<a href="\./([\w_]+\.html)">(.+?)</a>)(?=</li>)
replace:
\1

Alternately, if we're keeping the output as markdown: 
find:
^(\s*- )(\[([^\]]+)\]\(\./([\w_]+\.html)\))
replace:
\1\2
 -->

<h4>Navigation</h4>

<ul>
<li><a href="./intro.html">Introduction</a></li>
<li><a href="./overview.html">Overview</a></li>
<li><a href="./installing.html">Installing</a></li>
<li><strong>Upgrading</strong></li>
<li><a href="./using.html">Using Puppet Enterprise</a></li>
<li>The Accounts Module
<ul>
<li><a href="./accounts_user_type.html">The <code>accounts::user</code> Type</a></li>
<li><a href="./accounts_class.html">The <code>accounts</code> Class</a>
</li>
</ul></li>
<li>Puppet Compliance
<ul>
<li><a href="./compliance_basics.html">Puppet Compliance Basics and UI</a></li>
<li><a href="./using_compliance.html">Using the Puppet Compliance Workflow</a></li>
<li><a href="./compliance_tutorial.html">Compliance Workflow Tutorial</a></li>
</ul></li>
<li><a href="./known_issues.html">Known Issues</a></li>
<li><a href="./troubleshooting.html">Troubleshooting</a></li>
<li><a href="./answer_file_reference.html">Answer File Reference</a></li>
</ul>

<h1 id="upgrading-from-puppet-enterprise-1x">Upgrading From Puppet Enterprise 1.x</h1>

<p>Puppet Enterprise ships with an upgrade script that will do a large part of the work of upgrading your installation. However, you will have to finish the configuration of PE 1.2 manually. </p>

<p>To upgrade to PE 1.2, you must:</p>

<ul>
  <li>Download and unarchive the PE tarball.</li>
  <li>Run the <code>puppet-enterprise-upgrader</code> script.</li>
  <li>Create a new database for the inventory service and grant all permissions on it to the dashboard MySQL user. </li>
  <li>Manually edit the <code>puppet.conf</code>, <code>auth.conf</code>, <code>site.pp</code>, and <code>settings.yml</code> files on your puppet master. </li>
  <li>Generate and sign certificates for Puppet Dashboard to enable inventory and filebucket viewing. </li>
  <li>Restart <code>pe-httpd</code>.</li>
</ul>

<h2 id="choosing-your-installer-tarball">Choosing Your Installer Tarball</h2>

<p>Puppet Enterprise can be downloaded in tarballs specific to your OS and version, or as a universal tarball. Although the universal archive can be more convenient, it is roughly ten times the size of the version-specific archives.</p>

<table>
  <thead>
    <tr>
      <th>Filename ends with&hellip;</th>
      <th>Will install&hellip;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>-all.tar</code></td>
      <td>anywhere</td>
    </tr>
    <tr>
      <td><code>-debian-&lt;version and arch&gt;.tar</code></td>
      <td>on Debian</td>
    </tr>
    <tr>
      <td><code>-el-&lt;version and arch&gt;.tar</code></td>
      <td>on RHEL, CentOS, Scientific Linux, or Oracle Enterprise Linux</td>
    </tr>
    <tr>
      <td><code>-sles-&lt;version and arch&gt;.tar</code></td>
      <td>on SUSE Linux Enterprise Server</td>
    </tr>
    <tr>
      <td><code>-solaris-&lt;version and arch&gt;.tar</code></td>
      <td>on Solaris</td>
    </tr>
    <tr>
      <td><code>-ubuntu-&lt;version and arch&gt;.tar</code></td>
      <td>on Ubuntu LTS</td>
    </tr>
  </tbody>
</table>

<h2 id="running-the-upgrader">Running the Upgrader</h2>

<p>Once you&rsquo;ve retrieved a PE tarball, you should unarchive it, navigate to the resulting directory, and run <code>./puppet-enterprise-upgrader</code>. This script will examine your system to determine which Puppet Enterprise roles are currently installed, then list the packages these roles will require and ask if you want to continue with the upgrade. <strong>Note that the list of packages shown is not complete:</strong> any new dependencies from your operating system&rsquo;s repositories will be installed without confirmation, and the upgrade may fail if you are not connected to the source of these packages. Note also that <strong>upgrades to PE 1.x systems with the Puppet Dashboard role and no puppet agent role may not upgrade cleanly,</strong> as this configuration is no longer supported under PE 1.2. We recommend that you run the <code>puppet-enterprise-installer</code> script in this situation, although this upgrade path has not been thoroughly tested. </p>

<p>After receiving confirmation, the upgrader will update existing packages, install new packages added in this version of PE, and run additional scripts or puppet manifests to make the system similar (though not necessarily identical) to a new installation of PE 1.2. </p>

<h2 id="upgrading-puppet-agent">Upgrading Puppet Agent</h2>

<p>The puppet agent role requires no additional upgrade steps. For machines running only the agent role, you don&rsquo;t need to do anything beyond run the upgrader script. </p>

<p>As with a new installation, you need to <a href="./using.html#enabling-mcollective">assign the <code>mcollectivepe</code> class</a> to an agent node in order to enable MCollective.</p>

<h2 id="upgrading-puppet-master-and-puppet-dashboard">Upgrading Puppet Master and Puppet Dashboard</h2>

<p>If you are running the puppet master and Puppet Dashboard roles on the same machine, you will need to perform some additional steps to complete the upgrade. <strong>Puppet and Puppet Dashboard will continue to perform properly even if you skip these steps,</strong> but they are necessary to enable new features added in version 1.2. </p>

<h3 id="create-a-new-inventory-database">Create a New Inventory Database</h3>

<p>To support the inventory service, you must manually create a new database for puppet master to store node facts in. To do this, use the <code>mysql</code> client on the server providing the database. The server providing the database will almost always be the server running puppet master and Dashboard. </p>

<pre><code># mysql -uroot -p
Enter password: 
mysql&gt; CREATE DATABASE dashboard_inventory_service;
mysql&gt; GRANT ALL PRIVILEGES ON dashboard_inventory_service.* TO 'dashboard'@'localhost';
</code></pre>

<p>If you chose a different MySQL user name for Puppet Dashboard when you originally installed PE, use that user name instead of &ldquo;dashboard&rdquo;. If the database is served by a remote machine, use the hostname of the master/Dashboard server instead of &ldquo;localhost&rdquo;. </p>

<h3 id="edit-etcpuppetlabspuppetpuppetconf">Edit <code>/etc/puppetlabs/puppet/puppet.conf</code></h3>

<ul>
  <li>
    <p>To use the new <code>accounts, mcollectivepe, stdlib,</code> and <code>baselines</code> modules, you must add the the <code>/opt/puppet/share/puppet/modules</code> directory to Puppet&rsquo;s <code>modulepath</code>: </p>

    <pre><code>  [main]
      modulepath = /etc/puppetlabs/puppet/modules:/opt/puppet/share/puppet/modules
</code></pre>

    <p>Note that if you were previously using an older version of the <code>stdlib</code> module, or any modules with the same name as the <code>accounts, mcollectivepe,</code> or <code>baselines</code> modules, you will have to delete them in order to use the modules included with PE 1.2.</p>
  </li>
  <li>
    <p>To support the inventory service, you must configure Puppet to save facts to a MySQL database.</p>

    <pre><code>  [master]
      facts_terminus = inventory_active_record
      dbadapter = mysql
      dbname = dashboard_inventory_service
      dbuser = dashboard
      dbpassword = &lt;MySQL password for dashboard user&gt;
      dbserver = localhost
</code></pre>

    <p>If you chose a different MySQL user name for Puppet Dashboard when you originally installed PE, use that user name as the <code>dbuser</code> instead of &ldquo;dashboard&rdquo;. If the database is served by a remote machine, use that server&rsquo;s hostname instead of &ldquo;localhost&rdquo;. </p>
  </li>
  <li>
    <p>To support filebucket viewing when using the Puppet Compliance workflow, you must set <code>archive_files</code> to true for puppet inspect:</p>

    <pre><code>  [main]
      archive_files = true
</code></pre>
  </li>
</ul>

<h3 id="edit-etcpuppetlabspuppetauthconf">Edit <code>/etc/puppetlabs/puppet/auth.conf</code></h3>

<p>To support the inventory service, you must add the following stanzas to your <a href="http://docs.puppetlabs.com/guides/rest_auth_conf.html"><code>auth.conf</code></a> file:</p>

<pre><code># Allow Dashboard to retrieve inventory facts:

path /facts
auth yes
method find, search
allow dashboard

# Allow puppet master to save facts to the inventory:

path /facts
auth yes
method save
allow &lt;puppet master's certname&gt;
</code></pre>

<p>These stanzas <strong>must</strong> be inserted <strong>before</strong> the final stanza:</p>

<pre><code>...method save
allow &lt;puppet master's certname&gt;

# final auth.conf stanza:

path /
auth any
</code></pre>

<p>If you paste these stanzas at the end of <code>auth.conf</code>, they will have no effect.</p>

<h3 id="edit-etcpuppetlabspuppetmanifestssitepp">Edit <code>/etc/puppetlabs/puppet/manifests/site.pp</code></h3>

<p>Even if you don&rsquo;t use <code>site.pp</code> to classify nodes, you must add the following resource and resource default in order to support Puppet Dashboard&rsquo;s filebucket viewing capabilities:</p>

<pre><code># specify remote filebucket
filebucket { 'main':
  server =&gt; '&lt;puppet master's hostname&gt;',
  path =&gt; false,
}

File { backup =&gt; 'main' }
</code></pre>

<p>This will cause all agent nodes to back up their file contents to the puppet master, which will then serve the files to Dashboard on demand. </p>

<h3 id="edit-etcpuppetlabspuppet-dashboardsettingsyml">Edit <code>/etc/puppetlabs/puppet-dashboard/settings.yml</code></h3>

<p>To turn on inventory and filebucket viewing, you must ensure that the following two options in <code>settings.yml</code> are set to true:</p>

<pre><code>enable_inventory_service: true
use_file_bucket_diffs: true
</code></pre>

<p>You&rsquo;ll also need to ensure that the following three settings point to one of the puppet master&rsquo;s certified hostnames:</p>

<pre><code>ca_server: '&lt;puppet master's hostname&gt;'
inventory_server: '&lt;puppet master's hostname&gt;'
file_bucket_server: '&lt;puppet master's hostname&gt;'
</code></pre>

<h3 id="generate-and-sign-certificates-for-puppet-dashboard">Generate and Sign Certificates for Puppet Dashboard</h3>

<p>To support Dashboard&rsquo;s inventory and filebucket viewing capabilities, you must generate and sign certificates to allow it to request data from the puppet master.</p>

<p>First, navigate to Dashboard&rsquo;s installation directory:</p>

<pre><code>$ cd /opt/puppet/share/puppet-dashboard
</code></pre>

<p>Next, create a keypair and request a certificate:</p>

<pre><code>$ sudo /opt/puppet/bin/rake cert:create_key_pair
$ sudo /opt/puppet/bin/rake cert:request
</code></pre>

<p>Next, sign the certificate request: </p>

<pre><code>$ sudo /opt/puppet/bin/puppet cert sign dashboard
</code></pre>

<p>Next, retrieve the signed certificate:</p>

<pre><code>$ sudo /opt/puppet/bin/rake cert:retrieve
</code></pre>

<p>And finally, make <code>puppet-dashboard</code> the owner of the certificates directory:</p>

<pre><code>$ sudo chown -R puppet-dashboard:puppet-dashboard certs
</code></pre>

<h3 id="restart-pe-httpd">Restart <code>pe-httpd</code></h3>

<p>To reload all of the relevant puppet master and Dashboard config files, restart Apache:</p>

<pre><code>$ sudo /etc/init.d/pe-httpd restart
</code></pre>

<p>And you&rsquo;re done!</p>

<h2 id="upgrading-puppet-master-without-dashboard">Upgrading Puppet Master Without Dashboard</h2>

<p>If you are not using Puppet Dashboard at your site, upgrading puppet master is significantly simpler.</p>

<h3 id="edit-etcpuppetlabspuppetpuppetconf-1">Edit <code>/etc/puppetlabs/puppet/puppet.conf</code></h3>

<ul>
  <li>
    <p>To use the new <code>accounts, mcollectivepe, stdlib,</code> and <code>baselines</code> modules, you must add the the <code>/opt/puppet/share/puppet/modules</code> directory to Puppet&rsquo;s <code>modulepath</code>: </p>

    <pre><code>  [main]
      modulepath = /etc/puppetlabs/puppet/modules:/opt/puppet/share/puppet/modules
</code></pre>
  </li>
</ul>

<h2 id="upgrading-separated-puppet-master-and-puppet-dashboard-servers">Upgrading Separated Puppet Master and Puppet Dashboard Servers</h2>

<h3 id="coming-soon">Coming Soon</h3>

<p>Upgrading to PE 1.2 in cases where puppet master and Puppet Dashboard are being run on different servers is significantly more complicated. This upgrade procedure is not yet documented, and will be added to the manual at a later date. </p>

            </div>
            <div class="secondary-content">
                  <div id="subCol">
                  
                  
                      <h3 class="chapter">Contents</h3>
                      
<ol class="toc">
  <li class="toc-lv2"><a href="#choosing-your-installer-tarball">Choosing Your Installer Tarball</a></li>
  <li class="toc-lv2"><a href="#running-the-upgrader">Running the Upgrader</a></li>
  <li class="toc-lv2"><a href="#upgrading-puppet-agent">Upgrading Puppet Agent</a></li>
  <li class="toc-lv2"><a href="#upgrading-puppet-master-and-puppet-dashboard">Upgrading Puppet Master and Puppet Dashboard</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#create-a-new-inventory-database">Create a New Inventory Database</a></li>
   <li class="toc-lv3"><a href="#edit-etcpuppetlabspuppetpuppetconf">Edit /etc/puppetlabs/puppet/puppet.conf</a></li>
   <li class="toc-lv3"><a href="#edit-etcpuppetlabspuppetauthconf">Edit /etc/puppetlabs/puppet/auth.conf</a></li>
   <li class="toc-lv3"><a href="#edit-etcpuppetlabspuppetmanifestssitepp">Edit /etc/puppetlabs/puppet/manifests/site.pp</a></li>
   <li class="toc-lv3"><a href="#edit-etcpuppetlabspuppet-dashboardsettingsyml">Edit /etc/puppetlabs/puppet-dashboard/settings.yml</a></li>
   <li class="toc-lv3"><a href="#generate-and-sign-certificates-for-puppet-dashboard">Generate and Sign Certificates for Puppet Dashboard</a></li>
   <li class="toc-lv3"><a href="#restart-pe-httpd">Restart pe-httpd</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#upgrading-puppet-master-without-dashboard">Upgrading Puppet Master Without Dashboard</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#edit-etcpuppetlabspuppetpuppetconf-1">Edit /etc/puppetlabs/puppet/puppet.conf</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#upgrading-separated-puppet-master-and-puppet-dashboard-servers">Upgrading Separated Puppet Master and Puppet Dashboard Servers</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#coming-soon">Coming Soon</a></li>
</ol></li>
</ol>
                  
                                        <!-- New Ads are inserted here -->
		  			<div id="bannerImage" style="display:block;">&nbsp;</div>
		  			<!-- Remove me on September 24 --><a href="http://bit.ly/puppetconf"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/07/120x600_puppetconf.png" style="display:block; margin-left: auto; margin-right: auto;"></a>
                  </div>
            </div>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>  
		<h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>
              
				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save"; id="mktForm_1013" name="mktForm_1013">
				
				<label>Email Address:</label><span class='mktInput'><input class='mktFormText mktFormEmail' name="Email" id="Email" type='text' value="" maxlength='255'  /><span class='mktFormMsg'></span></span>
				
				<input id='mktFrmSubmit' type='submit' class='btn' style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value='Subscribe' name='submitButton' onclick='formSubmit(document.getElementById("mktForm_1013")); return false;' />
				
				<input style='display: none;' id='mktFrmReset' type='reset' value='Clear' name='resetButton' onclick='formReset(document.getElementById("mktForm_1013")); return false;' />
	
				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />
				
				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&kw={keyword}"; />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>
				
				<script type="text/javascript">
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				</script>
              
<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>
                
                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>	

              </ul>
		<p>
		              		<h4>Follow us&#8230;</h4>

              		<ul class="followus">

					
			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0"></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0"></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0"></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0"></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0"></a></li>
					</ul>

              	</p>

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>Written by James Turnbull and Jeff McCune, <a href="http://www.apress.com/9781430230571" rel="nofollow">Pro Puppet</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430230571" rel="nofollow"><img src="http://www.puppetlabs.com/wp-content/uploads/2011/05/propuppetthumb.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">411 NW Park Avenue</span>
           /
           <span class="locality">Portland</span>, 
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>          
      </div>
    </div>
    <script src="http://munchkin.marketo.net/munchkin.js" type="text/javascript"></script> <script>mktoMunchkin("307-QLA-991");</script> 
    
  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>

	</body>
</html>        
